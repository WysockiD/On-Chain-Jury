{"ast":null,"code":"var __extends = this && this.__extends || function () {\n  var extendStatics = function (d, b) {\n    extendStatics = Object.setPrototypeOf || {\n      __proto__: []\n    } instanceof Array && function (d, b) {\n      d.__proto__ = b;\n    } || function (d, b) {\n      for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p];\n    };\n\n    return extendStatics(d, b);\n  };\n\n  return function (d, b) {\n    extendStatics(d, b);\n\n    function __() {\n      this.constructor = d;\n    }\n\n    d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\n  };\n}();\n\nvar __assign = this && this.__assign || function () {\n  __assign = Object.assign || function (t) {\n    for (var s, i = 1, n = arguments.length; i < n; i++) {\n      s = arguments[i];\n\n      for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p)) t[p] = s[p];\n    }\n\n    return t;\n  };\n\n  return __assign.apply(this, arguments);\n};\n\nimport React from 'react';\nimport { buildClientSchema, parse, print } from 'graphql';\nimport copyToClipboard from 'copy-to-clipboard';\nimport { ExecuteButton } from './ExecuteButton';\nimport { ImagePreview } from './ImagePreview';\nimport { ToolbarButton } from './ToolbarButton';\nimport { ToolbarGroup } from './ToolbarGroup';\nimport { ToolbarMenu, ToolbarMenuItem } from './ToolbarMenu';\nimport { QueryEditor } from './QueryEditor';\nimport { VariableEditor } from './VariableEditor';\nimport { HeaderEditor } from './HeaderEditor';\nimport { ResultViewer } from './ResultViewer';\nimport { DocExplorer } from './DocExplorer';\nimport { QueryHistory } from './QueryHistory';\nimport CodeMirrorSizer from '../utility/CodeMirrorSizer';\nimport StorageAPI from '../utility/StorageAPI';\nimport getQueryFacts from '../utility/getQueryFacts';\nimport getSelectedOperationName from '../utility/getSelectedOperationName';\nimport debounce from '../utility/debounce';\nimport find from '../utility/find';\nimport { fillLeafs } from '../utility/fillLeafs';\nimport { getLeft, getTop } from '../utility/elementPosition';\nimport mergeAST from '../utility/mergeAst';\nimport { introspectionQuery, introspectionQueryName, introspectionQuerySansSubscriptions } from '../utility/introspectionQueries';\nvar DEFAULT_DOC_EXPLORER_WIDTH = 350;\nvar majorVersion = parseInt(React.version.slice(0, 2), 10);\n\nif (majorVersion < 16) {\n  throw Error(['GraphiQL 0.18.0 and after is not compatible with React 15 or below.', 'If you are using a CDN source (jsdelivr, unpkg, etc), follow this example:', 'https://github.com/graphql/graphiql/blob/master/examples/graphiql-cdn/index.html#L49'].join('\\n'));\n}\n\nvar GraphiQL = function (_super) {\n  __extends(GraphiQL, _super);\n\n  function GraphiQL(props) {\n    var _a, _b;\n\n    var _this = _super.call(this, props) || this;\n\n    _this._editorQueryID = 0;\n\n    _this.safeSetState = function (nextState, callback) {\n      _this.componentIsMounted && _this.setState(nextState, callback);\n    };\n\n    _this.handleClickReference = function (reference) {\n      _this.setState({\n        docExplorerOpen: true\n      }, function () {\n        if (_this.docExplorerComponent) {\n          _this.docExplorerComponent.showDocForReference(reference);\n        }\n      });\n\n      _this._storage.set('docExplorerOpen', JSON.stringify(_this.state.docExplorerOpen));\n    };\n\n    _this.handleRunQuery = function (selectedOperationName) {\n      _this._editorQueryID++;\n      var queryID = _this._editorQueryID;\n\n      var editedQuery = _this.autoCompleteLeafs() || _this.state.query;\n\n      var variables = _this.state.variables;\n      var headers = _this.state.headers;\n      var shouldPersistHeaders = _this.state.shouldPersistHeaders;\n      var operationName = _this.state.operationName;\n\n      if (selectedOperationName && selectedOperationName !== operationName) {\n        operationName = selectedOperationName;\n\n        _this.handleEditOperationName(operationName);\n      }\n\n      try {\n        _this.setState({\n          isWaitingForResponse: true,\n          response: undefined,\n          operationName: operationName\n        });\n\n        _this._storage.set('operationName', operationName);\n\n        if (_this._queryHistory) {\n          _this._queryHistory.updateHistory(editedQuery, variables, headers, operationName);\n        }\n\n        var subscription = _this._fetchQuery(editedQuery, variables, headers, operationName, shouldPersistHeaders, function (result) {\n          if (queryID === _this._editorQueryID) {\n            _this.setState({\n              isWaitingForResponse: false,\n              response: GraphiQL.formatResult(result)\n            });\n          }\n        });\n\n        _this.setState({\n          subscription: subscription\n        });\n      } catch (error) {\n        _this.setState({\n          isWaitingForResponse: false,\n          response: error.message\n        });\n      }\n    };\n\n    _this.handleStopQuery = function () {\n      var subscription = _this.state.subscription;\n\n      _this.setState({\n        isWaitingForResponse: false,\n        subscription: null\n      });\n\n      if (subscription) {\n        subscription.unsubscribe();\n      }\n    };\n\n    _this.handlePrettifyQuery = function () {\n      var _a, _b, _c;\n\n      var editor = _this.getQueryEditor();\n\n      var editorContent = (_a = editor === null || editor === void 0 ? void 0 : editor.getValue()) !== null && _a !== void 0 ? _a : '';\n      var prettifiedEditorContent = print(parse(editorContent));\n\n      if (prettifiedEditorContent !== editorContent) {\n        editor === null || editor === void 0 ? void 0 : editor.setValue(prettifiedEditorContent);\n      }\n\n      var variableEditor = _this.getVariableEditor();\n\n      var variableEditorContent = (_b = variableEditor === null || variableEditor === void 0 ? void 0 : variableEditor.getValue()) !== null && _b !== void 0 ? _b : '';\n\n      try {\n        var prettifiedVariableEditorContent = JSON.stringify(JSON.parse(variableEditorContent), null, 2);\n\n        if (prettifiedVariableEditorContent !== variableEditorContent) {\n          variableEditor === null || variableEditor === void 0 ? void 0 : variableEditor.setValue(prettifiedVariableEditorContent);\n        }\n      } catch (_d) {}\n\n      var headerEditor = _this.getHeaderEditor();\n\n      var headerEditorContent = (_c = headerEditor === null || headerEditor === void 0 ? void 0 : headerEditor.getValue()) !== null && _c !== void 0 ? _c : '';\n\n      try {\n        var prettifiedHeaderEditorContent = JSON.stringify(JSON.parse(headerEditorContent), null, 2);\n\n        if (prettifiedHeaderEditorContent !== headerEditorContent) {\n          headerEditor === null || headerEditor === void 0 ? void 0 : headerEditor.setValue(prettifiedHeaderEditorContent);\n        }\n      } catch (_e) {}\n    };\n\n    _this.handleMergeQuery = function () {\n      var editor = _this.getQueryEditor();\n\n      var query = editor.getValue();\n\n      if (!query) {\n        return;\n      }\n\n      var ast = parse(query);\n      editor.setValue(print(mergeAST(ast)));\n    };\n\n    _this.handleEditQuery = debounce(100, function (value) {\n      var queryFacts = _this._updateQueryFacts(value, _this.state.operationName, _this.state.operations, _this.state.schema);\n\n      _this.setState(__assign({\n        query: value\n      }, queryFacts));\n\n      _this._storage.set('query', value);\n\n      if (_this.props.onEditQuery) {\n        return _this.props.onEditQuery(value);\n      }\n    });\n\n    _this.handleCopyQuery = function () {\n      var editor = _this.getQueryEditor();\n\n      var query = editor && editor.getValue();\n\n      if (!query) {\n        return;\n      }\n\n      copyToClipboard(query);\n\n      if (_this.props.onCopyQuery) {\n        return _this.props.onCopyQuery(query);\n      }\n    };\n\n    _this._updateQueryFacts = function (query, operationName, prevOperations, schema) {\n      var queryFacts = getQueryFacts(schema, query);\n\n      if (queryFacts) {\n        var updatedOperationName = getSelectedOperationName(prevOperations, operationName, queryFacts.operations);\n        var onEditOperationName = _this.props.onEditOperationName;\n\n        if (onEditOperationName && updatedOperationName && operationName !== updatedOperationName) {\n          onEditOperationName(updatedOperationName);\n        }\n\n        return __assign({\n          operationName: updatedOperationName\n        }, queryFacts);\n      }\n    };\n\n    _this.handleEditVariables = function (value) {\n      _this.setState({\n        variables: value\n      });\n\n      debounce(500, function () {\n        return _this._storage.set('variables', value);\n      })();\n\n      if (_this.props.onEditVariables) {\n        _this.props.onEditVariables(value);\n      }\n    };\n\n    _this.handleEditHeaders = function (value) {\n      _this.setState({\n        headers: value\n      });\n\n      _this.props.shouldPersistHeaders && debounce(500, function () {\n        return _this._storage.set('headers', value);\n      })();\n\n      if (_this.props.onEditHeaders) {\n        _this.props.onEditHeaders(value);\n      }\n    };\n\n    _this.handleEditOperationName = function (operationName) {\n      var onEditOperationName = _this.props.onEditOperationName;\n\n      if (onEditOperationName) {\n        onEditOperationName(operationName);\n      }\n    };\n\n    _this.handleHintInformationRender = function (elem) {\n      elem.addEventListener('click', _this._onClickHintInformation);\n      var onRemoveFn;\n      elem.addEventListener('DOMNodeRemoved', onRemoveFn = function () {\n        elem.removeEventListener('DOMNodeRemoved', onRemoveFn);\n        elem.removeEventListener('click', _this._onClickHintInformation);\n      });\n    };\n\n    _this.handleEditorRunQuery = function () {\n      _this._runQueryAtCursor();\n    };\n\n    _this._onClickHintInformation = function (event) {\n      if ((event === null || event === void 0 ? void 0 : event.currentTarget) && 'className' in event.currentTarget && event.currentTarget.className === 'typeName') {\n        var typeName = event.currentTarget.innerHTML;\n        var schema = _this.state.schema;\n\n        if (schema) {\n          var type_1 = schema.getType(typeName);\n\n          if (type_1) {\n            _this.setState({\n              docExplorerOpen: true\n            }, function () {\n              if (_this.docExplorerComponent) {\n                _this.docExplorerComponent.showDoc(type_1);\n              }\n            });\n\n            debounce(500, function () {\n              return _this._storage.set('docExplorerOpen', JSON.stringify(_this.state.docExplorerOpen));\n            })();\n          }\n        }\n      }\n    };\n\n    _this.handleToggleDocs = function () {\n      if (typeof _this.props.onToggleDocs === 'function') {\n        _this.props.onToggleDocs(!_this.state.docExplorerOpen);\n      }\n\n      _this._storage.set('docExplorerOpen', JSON.stringify(!_this.state.docExplorerOpen));\n\n      _this.setState({\n        docExplorerOpen: !_this.state.docExplorerOpen\n      });\n    };\n\n    _this.handleToggleHistory = function () {\n      if (typeof _this.props.onToggleHistory === 'function') {\n        _this.props.onToggleHistory(!_this.state.historyPaneOpen);\n      }\n\n      _this._storage.set('historyPaneOpen', JSON.stringify(!_this.state.historyPaneOpen));\n\n      _this.setState({\n        historyPaneOpen: !_this.state.historyPaneOpen\n      });\n    };\n\n    _this.handleSelectHistoryQuery = function (query, variables, headers, operationName) {\n      if (query) {\n        _this.handleEditQuery(query);\n      }\n\n      if (variables) {\n        _this.handleEditVariables(variables);\n      }\n\n      if (headers) {\n        _this.handleEditHeaders(headers);\n      }\n\n      if (operationName) {\n        _this.handleEditOperationName(operationName);\n      }\n    };\n\n    _this.handleResizeStart = function (downEvent) {\n      if (!_this._didClickDragBar(downEvent)) {\n        return;\n      }\n\n      downEvent.preventDefault();\n      var offset = downEvent.clientX - getLeft(downEvent.target);\n\n      var onMouseMove = function (moveEvent) {\n        if (moveEvent.buttons === 0) {\n          return onMouseUp();\n        }\n\n        var editorBar = _this.editorBarComponent;\n        var leftSize = moveEvent.clientX - getLeft(editorBar) - offset;\n        var rightSize = editorBar.clientWidth - leftSize;\n\n        _this.setState({\n          editorFlex: leftSize / rightSize\n        });\n\n        debounce(500, function () {\n          return _this._storage.set('editorFlex', JSON.stringify(_this.state.editorFlex));\n        })();\n      };\n\n      var onMouseUp = function () {\n        document.removeEventListener('mousemove', onMouseMove);\n        document.removeEventListener('mouseup', onMouseUp);\n        onMouseMove = null;\n        onMouseUp = null;\n      };\n\n      document.addEventListener('mousemove', onMouseMove);\n      document.addEventListener('mouseup', onMouseUp);\n    };\n\n    _this.handleResetResize = function () {\n      _this.setState({\n        editorFlex: 1\n      });\n\n      _this._storage.set('editorFlex', JSON.stringify(_this.state.editorFlex));\n    };\n\n    _this.handleDocsResizeStart = function (downEvent) {\n      downEvent.preventDefault();\n      var hadWidth = _this.state.docExplorerWidth;\n      var offset = downEvent.clientX - getLeft(downEvent.target);\n\n      var onMouseMove = function (moveEvent) {\n        if (moveEvent.buttons === 0) {\n          return onMouseUp();\n        }\n\n        var app = _this.graphiqlContainer;\n        var cursorPos = moveEvent.clientX - getLeft(app) - offset;\n        var docsSize = app.clientWidth - cursorPos;\n\n        if (docsSize < 100) {\n          _this.setState({\n            docExplorerOpen: false\n          });\n        } else {\n          _this.setState({\n            docExplorerOpen: true,\n            docExplorerWidth: Math.min(docsSize, 650)\n          });\n\n          debounce(500, function () {\n            return _this._storage.set('docExplorerWidth', JSON.stringify(_this.state.docExplorerWidth));\n          })();\n        }\n\n        _this._storage.set('docExplorerOpen', JSON.stringify(_this.state.docExplorerOpen));\n      };\n\n      var onMouseUp = function () {\n        if (!_this.state.docExplorerOpen) {\n          _this.setState({\n            docExplorerWidth: hadWidth\n          });\n\n          debounce(500, function () {\n            return _this._storage.set('docExplorerWidth', JSON.stringify(_this.state.docExplorerWidth));\n          })();\n        }\n\n        document.removeEventListener('mousemove', onMouseMove);\n        document.removeEventListener('mouseup', onMouseUp);\n        onMouseMove = null;\n        onMouseUp = null;\n      };\n\n      document.addEventListener('mousemove', onMouseMove);\n      document.addEventListener('mouseup', onMouseUp);\n    };\n\n    _this.handleDocsResetResize = function () {\n      _this.setState({\n        docExplorerWidth: DEFAULT_DOC_EXPLORER_WIDTH\n      });\n\n      debounce(500, function () {\n        return _this._storage.set('docExplorerWidth', JSON.stringify(_this.state.docExplorerWidth));\n      })();\n    };\n\n    _this.handleTabClickPropogation = function (downEvent) {\n      downEvent.preventDefault();\n      downEvent.stopPropagation();\n    };\n\n    _this.handleOpenHeaderEditorTab = function (_clickEvent) {\n      _this.setState({\n        headerEditorActive: true,\n        variableEditorActive: false,\n        secondaryEditorOpen: true\n      });\n    };\n\n    _this.handleOpenVariableEditorTab = function (_clickEvent) {\n      _this.setState({\n        headerEditorActive: false,\n        variableEditorActive: true,\n        secondaryEditorOpen: true\n      });\n    };\n\n    _this.handleSecondaryEditorResizeStart = function (downEvent) {\n      downEvent.preventDefault();\n      var didMove = false;\n      var wasOpen = _this.state.secondaryEditorOpen;\n      var hadHeight = _this.state.secondaryEditorHeight;\n      var offset = downEvent.clientY - getTop(downEvent.target);\n\n      var onMouseMove = function (moveEvent) {\n        if (moveEvent.buttons === 0) {\n          return onMouseUp();\n        }\n\n        didMove = true;\n        var editorBar = _this.editorBarComponent;\n        var topSize = moveEvent.clientY - getTop(editorBar) - offset;\n        var bottomSize = editorBar.clientHeight - topSize;\n\n        if (bottomSize < 60) {\n          _this.setState({\n            secondaryEditorOpen: false,\n            secondaryEditorHeight: hadHeight\n          });\n        } else {\n          _this.setState({\n            secondaryEditorOpen: true,\n            secondaryEditorHeight: bottomSize\n          });\n        }\n\n        debounce(500, function () {\n          return _this._storage.set('secondaryEditorHeight', JSON.stringify(_this.state.secondaryEditorHeight));\n        })();\n      };\n\n      var onMouseUp = function () {\n        if (!didMove) {\n          _this.setState({\n            secondaryEditorOpen: !wasOpen\n          });\n        }\n\n        document.removeEventListener('mousemove', onMouseMove);\n        document.removeEventListener('mouseup', onMouseUp);\n        onMouseMove = null;\n        onMouseUp = null;\n      };\n\n      document.addEventListener('mousemove', onMouseMove);\n      document.addEventListener('mouseup', onMouseUp);\n    };\n\n    if (typeof props.fetcher !== 'function') {\n      throw new TypeError('GraphiQL requires a fetcher function.');\n    }\n\n    _this._storage = new StorageAPI(props.storage);\n    _this.componentIsMounted = false;\n    var query = props.query !== undefined ? props.query : _this._storage.get('query') ? _this._storage.get('query') : props.defaultQuery !== undefined ? props.defaultQuery : defaultQuery;\n    var queryFacts = getQueryFacts(props.schema, query);\n    var variables = props.variables !== undefined ? props.variables : _this._storage.get('variables');\n    var headers = props.headers !== undefined ? props.headers : _this._storage.get('headers');\n    var operationName = props.operationName !== undefined ? props.operationName : getSelectedOperationName(undefined, _this._storage.get('operationName'), queryFacts && queryFacts.operations);\n    var docExplorerOpen = props.docExplorerOpen || false;\n\n    if (_this._storage.get('docExplorerOpen')) {\n      docExplorerOpen = _this._storage.get('docExplorerOpen') === 'true';\n    }\n\n    var secondaryEditorOpen;\n\n    if (props.defaultVariableEditorOpen !== undefined) {\n      secondaryEditorOpen = props.defaultVariableEditorOpen;\n    } else if (props.defaultSecondaryEditorOpen !== undefined) {\n      secondaryEditorOpen = props.defaultSecondaryEditorOpen;\n    } else {\n      secondaryEditorOpen = Boolean(variables || headers);\n    }\n\n    var headerEditorEnabled = (_a = props.headerEditorEnabled) !== null && _a !== void 0 ? _a : false;\n    var shouldPersistHeaders = (_b = props.shouldPersistHeaders) !== null && _b !== void 0 ? _b : false;\n    _this.state = __assign({\n      schema: props.schema,\n      query: query,\n      variables: variables,\n      headers: headers,\n      operationName: operationName,\n      docExplorerOpen: docExplorerOpen,\n      response: props.response,\n      editorFlex: Number(_this._storage.get('editorFlex')) || 1,\n      secondaryEditorOpen: secondaryEditorOpen,\n      secondaryEditorHeight: Number(_this._storage.get('secondaryEditorHeight')) || 200,\n      variableEditorActive: _this._storage.get('variableEditorActive') === 'true' || props.headerEditorEnabled ? _this._storage.get('headerEditorActive') !== 'true' : secondaryEditorOpen && true,\n      headerEditorActive: _this._storage.get('headerEditorActive') === 'true',\n      headerEditorEnabled: headerEditorEnabled,\n      shouldPersistHeaders: shouldPersistHeaders,\n      historyPaneOpen: _this._storage.get('historyPaneOpen') === 'true' || false,\n      docExplorerWidth: Number(_this._storage.get('docExplorerWidth')) || DEFAULT_DOC_EXPLORER_WIDTH,\n      isWaitingForResponse: false,\n      subscription: null\n    }, queryFacts);\n    return _this;\n  }\n\n  GraphiQL.formatResult = function (result) {\n    return JSON.stringify(result, null, 2);\n  };\n\n  GraphiQL.formatError = function (rawError) {\n    var result = Array.isArray(rawError) ? rawError.map(formatSingleError) : formatSingleError(rawError);\n    return JSON.stringify(result, null, 2);\n  };\n\n  GraphiQL.prototype.componentDidMount = function () {\n    this.componentIsMounted = true;\n\n    if (this.state.schema === undefined) {\n      this.fetchSchema();\n    }\n\n    this.codeMirrorSizer = new CodeMirrorSizer();\n    global.g = this;\n  };\n\n  GraphiQL.prototype.UNSAFE_componentWillMount = function () {\n    this.componentIsMounted = false;\n  };\n\n  GraphiQL.prototype.UNSAFE_componentWillReceiveProps = function (nextProps) {\n    var _this = this;\n\n    var nextSchema = this.state.schema;\n    var nextQuery = this.state.query;\n    var nextVariables = this.state.variables;\n    var nextHeaders = this.state.headers;\n    var nextOperationName = this.state.operationName;\n    var nextResponse = this.state.response;\n\n    if (nextProps.schema !== undefined) {\n      nextSchema = nextProps.schema;\n    }\n\n    if (nextProps.query !== undefined && this.props.query !== nextProps.query) {\n      nextQuery = nextProps.query;\n    }\n\n    if (nextProps.variables !== undefined && this.props.variables !== nextProps.variables) {\n      nextVariables = nextProps.variables;\n    }\n\n    if (nextProps.headers !== undefined && this.props.headers !== nextProps.headers) {\n      nextHeaders = nextProps.headers;\n    }\n\n    if (nextProps.operationName !== undefined) {\n      nextOperationName = nextProps.operationName;\n    }\n\n    if (nextProps.response !== undefined) {\n      nextResponse = nextProps.response;\n    }\n\n    if (nextQuery && nextSchema && (nextSchema !== this.state.schema || nextQuery !== this.state.query || nextOperationName !== this.state.operationName)) {\n      var updatedQueryAttributes = this._updateQueryFacts(nextQuery, nextOperationName, this.state.operations, nextSchema);\n\n      if (updatedQueryAttributes !== undefined) {\n        nextOperationName = updatedQueryAttributes.operationName;\n        this.setState(updatedQueryAttributes);\n      }\n    }\n\n    if (nextProps.schema === undefined && nextProps.fetcher !== this.props.fetcher) {\n      nextSchema = undefined;\n    }\n\n    this._storage.set('operationName', nextOperationName);\n\n    this.setState({\n      schema: nextSchema,\n      query: nextQuery,\n      variables: nextVariables,\n      headers: nextHeaders,\n      operationName: nextOperationName,\n      response: nextResponse\n    }, function () {\n      if (_this.state.schema === undefined) {\n        if (_this.docExplorerComponent) {\n          _this.docExplorerComponent.reset();\n        }\n\n        _this.fetchSchema();\n      }\n    });\n  };\n\n  GraphiQL.prototype.componentDidUpdate = function () {\n    this.codeMirrorSizer.updateSizes([this.queryEditorComponent, this.variableEditorComponent, this.headerEditorComponent, this.resultComponent]);\n  };\n\n  GraphiQL.prototype.render = function () {\n    var _this = this;\n\n    var children = React.Children.toArray(this.props.children);\n    var logo = find(children, function (child) {\n      return isChildComponentType(child, GraphiQL.Logo);\n    }) || React.createElement(GraphiQL.Logo, null);\n    var toolbar = find(children, function (child) {\n      return isChildComponentType(child, GraphiQL.Toolbar);\n    }) || React.createElement(GraphiQL.Toolbar, null, React.createElement(ToolbarButton, {\n      onClick: this.handlePrettifyQuery,\n      title: \"Prettify Query (Shift-Ctrl-P)\",\n      label: \"Prettify\"\n    }), React.createElement(ToolbarButton, {\n      onClick: this.handleMergeQuery,\n      title: \"Merge Query (Shift-Ctrl-M)\",\n      label: \"Merge\"\n    }), React.createElement(ToolbarButton, {\n      onClick: this.handleCopyQuery,\n      title: \"Copy Query (Shift-Ctrl-C)\",\n      label: \"Copy\"\n    }), React.createElement(ToolbarButton, {\n      onClick: this.handleToggleHistory,\n      title: \"Show History\",\n      label: \"History\"\n    }));\n    var footer = find(children, function (child) {\n      return isChildComponentType(child, GraphiQL.Footer);\n    });\n    var queryWrapStyle = {\n      WebkitFlex: this.state.editorFlex,\n      flex: this.state.editorFlex\n    };\n    var docWrapStyle = {\n      display: 'block',\n      width: this.state.docExplorerWidth\n    };\n    var docExplorerWrapClasses = 'docExplorerWrap' + (this.state.docExplorerWidth < 200 ? ' doc-explorer-narrow' : '');\n    var historyPaneStyle = {\n      display: this.state.historyPaneOpen ? 'block' : 'none',\n      width: '230px',\n      zIndex: 7\n    };\n    var secondaryEditorOpen = this.state.secondaryEditorOpen;\n    var secondaryEditorStyle = {\n      height: secondaryEditorOpen ? this.state.secondaryEditorHeight : undefined\n    };\n    return React.createElement(\"div\", {\n      ref: function (n) {\n        _this.graphiqlContainer = n;\n      },\n      className: \"graphiql-container\"\n    }, React.createElement(\"div\", {\n      className: \"historyPaneWrap\",\n      style: historyPaneStyle\n    }, React.createElement(QueryHistory, {\n      ref: function (node) {\n        _this._queryHistory = node;\n      },\n      operationName: this.state.operationName,\n      query: this.state.query,\n      variables: this.state.variables,\n      onSelectQuery: this.handleSelectHistoryQuery,\n      storage: this._storage,\n      queryID: this._editorQueryID\n    }, React.createElement(\"button\", {\n      className: \"docExplorerHide\",\n      onClick: this.handleToggleHistory,\n      \"aria-label\": \"Close History\"\n    }, '\\u2715'))), React.createElement(\"div\", {\n      className: \"editorWrap\"\n    }, React.createElement(\"div\", {\n      className: \"topBarWrap\"\n    }, React.createElement(\"div\", {\n      className: \"topBar\"\n    }, logo, React.createElement(ExecuteButton, {\n      isRunning: Boolean(this.state.subscription),\n      onRun: this.handleRunQuery,\n      onStop: this.handleStopQuery,\n      operations: this.state.operations\n    }), toolbar), !this.state.docExplorerOpen && React.createElement(\"button\", {\n      className: \"docExplorerShow\",\n      onClick: this.handleToggleDocs,\n      \"aria-label\": \"Open Documentation Explorer\"\n    }, 'Docs')), React.createElement(\"div\", {\n      ref: function (n) {\n        _this.editorBarComponent = n;\n      },\n      className: \"editorBar\",\n      onDoubleClick: this.handleResetResize,\n      onMouseDown: this.handleResizeStart\n    }, React.createElement(\"div\", {\n      className: \"queryWrap\",\n      style: queryWrapStyle\n    }, React.createElement(QueryEditor, {\n      ref: function (n) {\n        _this.queryEditorComponent = n;\n      },\n      schema: this.state.schema,\n      value: this.state.query,\n      onEdit: this.handleEditQuery,\n      onHintInformationRender: this.handleHintInformationRender,\n      onClickReference: this.handleClickReference,\n      onCopyQuery: this.handleCopyQuery,\n      onPrettifyQuery: this.handlePrettifyQuery,\n      onMergeQuery: this.handleMergeQuery,\n      onRunQuery: this.handleEditorRunQuery,\n      editorTheme: this.props.editorTheme,\n      readOnly: this.props.readOnly\n    }), React.createElement(\"section\", {\n      className: \"variable-editor secondary-editor\",\n      style: secondaryEditorStyle,\n      \"aria-label\": this.state.variableEditorActive ? 'Query Variables' : 'Request Headers'\n    }, React.createElement(\"div\", {\n      className: \"secondary-editor-title variable-editor-title\",\n      id: \"secondary-editor-title\",\n      style: {\n        cursor: secondaryEditorOpen ? 'row-resize' : 'n-resize'\n      },\n      onMouseDown: this.handleSecondaryEditorResizeStart\n    }, React.createElement(\"div\", {\n      style: {\n        cursor: 'pointer',\n        color: this.state.variableEditorActive ? '#000' : 'gray',\n        display: 'inline-block'\n      },\n      onClick: this.handleOpenVariableEditorTab,\n      onMouseDown: this.handleTabClickPropogation\n    }, 'Query Variables'), this.state.headerEditorEnabled && React.createElement(\"div\", {\n      style: {\n        cursor: 'pointer',\n        color: this.state.headerEditorActive ? '#000' : 'gray',\n        display: 'inline-block',\n        marginLeft: '20px'\n      },\n      onClick: this.handleOpenHeaderEditorTab,\n      onMouseDown: this.handleTabClickPropogation\n    }, 'Request Headers')), React.createElement(VariableEditor, {\n      ref: function (n) {\n        _this.variableEditorComponent = n;\n      },\n      value: this.state.variables,\n      variableToType: this.state.variableToType,\n      onEdit: this.handleEditVariables,\n      onHintInformationRender: this.handleHintInformationRender,\n      onPrettifyQuery: this.handlePrettifyQuery,\n      onMergeQuery: this.handleMergeQuery,\n      onRunQuery: this.handleEditorRunQuery,\n      editorTheme: this.props.editorTheme,\n      readOnly: this.props.readOnly,\n      active: this.state.variableEditorActive\n    }), this.state.headerEditorEnabled && React.createElement(HeaderEditor, {\n      ref: function (n) {\n        _this.headerEditorComponent = n;\n      },\n      value: this.state.headers,\n      onEdit: this.handleEditHeaders,\n      onHintInformationRender: this.handleHintInformationRender,\n      onPrettifyQuery: this.handlePrettifyQuery,\n      onMergeQuery: this.handleMergeQuery,\n      onRunQuery: this.handleEditorRunQuery,\n      editorTheme: this.props.editorTheme,\n      readOnly: this.props.readOnly,\n      active: this.state.headerEditorActive\n    }))), React.createElement(\"div\", {\n      className: \"resultWrap\"\n    }, this.state.isWaitingForResponse && React.createElement(\"div\", {\n      className: \"spinner-container\"\n    }, React.createElement(\"div\", {\n      className: \"spinner\"\n    })), React.createElement(ResultViewer, {\n      registerRef: function (n) {\n        _this.resultViewerElement = n;\n      },\n      ref: function (c) {\n        _this.resultComponent = c;\n      },\n      value: this.state.response,\n      editorTheme: this.props.editorTheme,\n      ResultsTooltip: this.props.ResultsTooltip,\n      ImagePreview: ImagePreview\n    }), footer))), this.state.docExplorerOpen && React.createElement(\"div\", {\n      className: docExplorerWrapClasses,\n      style: docWrapStyle\n    }, React.createElement(\"div\", {\n      className: \"docExplorerResizer\",\n      onDoubleClick: this.handleDocsResetResize,\n      onMouseDown: this.handleDocsResizeStart\n    }), React.createElement(DocExplorer, {\n      ref: function (c) {\n        _this.docExplorerComponent = c;\n      },\n      schema: this.state.schema\n    }, React.createElement(\"button\", {\n      className: \"docExplorerHide\",\n      onClick: this.handleToggleDocs,\n      \"aria-label\": \"Close Documentation Explorer\"\n    }, '\\u2715'))));\n  };\n\n  GraphiQL.prototype.getQueryEditor = function () {\n    if (this.queryEditorComponent) {\n      return this.queryEditorComponent.getCodeMirror();\n    }\n  };\n\n  GraphiQL.prototype.getVariableEditor = function () {\n    if (this.variableEditorComponent) {\n      return this.variableEditorComponent.getCodeMirror();\n    }\n\n    return null;\n  };\n\n  GraphiQL.prototype.getHeaderEditor = function () {\n    if (this.headerEditorComponent) {\n      return this.headerEditorComponent.getCodeMirror();\n    }\n\n    return null;\n  };\n\n  GraphiQL.prototype.refresh = function () {\n    if (this.queryEditorComponent) {\n      this.queryEditorComponent.getCodeMirror().refresh();\n    }\n\n    if (this.variableEditorComponent) {\n      this.variableEditorComponent.getCodeMirror().refresh();\n    }\n\n    if (this.headerEditorComponent) {\n      this.headerEditorComponent.getCodeMirror().refresh();\n    }\n\n    if (this.resultComponent) {\n      this.resultComponent.getCodeMirror().refresh();\n    }\n  };\n\n  GraphiQL.prototype.autoCompleteLeafs = function () {\n    var _a = fillLeafs(this.state.schema, this.state.query, this.props.getDefaultFieldNames),\n        insertions = _a.insertions,\n        result = _a.result;\n\n    if (insertions && insertions.length > 0) {\n      var editor_1 = this.getQueryEditor();\n\n      if (editor_1) {\n        editor_1.operation(function () {\n          var cursor = editor_1.getCursor();\n          var cursorIndex = editor_1.indexFromPos(cursor);\n          editor_1.setValue(result || '');\n          var added = 0;\n          var markers = insertions.map(function (_a) {\n            var index = _a.index,\n                string = _a.string;\n            return editor_1.markText(editor_1.posFromIndex(index + added), editor_1.posFromIndex(index + (added += string.length)), {\n              className: 'autoInsertedLeaf',\n              clearOnEnter: true,\n              title: 'Automatically added leaf fields'\n            });\n          });\n          setTimeout(function () {\n            return markers.forEach(function (marker) {\n              return marker.clear();\n            });\n          }, 7000);\n          var newCursorIndex = cursorIndex;\n          insertions.forEach(function (_a) {\n            var index = _a.index,\n                string = _a.string;\n\n            if (index < cursorIndex) {\n              newCursorIndex += string.length;\n            }\n          });\n          editor_1.setCursor(editor_1.posFromIndex(newCursorIndex));\n        });\n      }\n    }\n\n    return result;\n  };\n\n  GraphiQL.prototype.fetchSchema = function () {\n    var _this = this;\n\n    var fetcher = this.props.fetcher;\n    var fetcherOpts = {\n      shouldPersistHeaders: Boolean(this.props.shouldPersistHeaders)\n    };\n\n    if (this.state.headers && this.state.headers.trim().length > 2) {\n      fetcherOpts.headers = JSON.parse(this.state.headers);\n    } else if (this.props.headers) {\n      fetcherOpts.headers = JSON.parse(this.props.headers);\n    }\n\n    var fetch = observableToPromise(fetcher({\n      query: introspectionQuery,\n      operationName: introspectionQueryName\n    }, fetcherOpts));\n\n    if (!isPromise(fetch)) {\n      this.setState({\n        response: 'Fetcher did not return a Promise for introspection.'\n      });\n      return;\n    }\n\n    fetch.then(function (result) {\n      if (typeof result !== 'string' && 'data' in result) {\n        return result;\n      }\n\n      var fetch2 = observableToPromise(fetcher({\n        query: introspectionQuerySansSubscriptions,\n        operationName: introspectionQueryName\n      }, fetcherOpts));\n\n      if (!isPromise(fetch)) {\n        throw new Error('Fetcher did not return a Promise for introspection.');\n      }\n\n      return fetch2;\n    }).then(function (result) {\n      if (_this.state.schema !== undefined) {\n        return;\n      }\n\n      if (typeof result !== 'string' && 'data' in result) {\n        var schema = buildClientSchema(result.data);\n        var queryFacts = getQueryFacts(schema, _this.state.query);\n\n        _this.safeSetState(__assign({\n          schema: schema\n        }, queryFacts));\n      } else {\n        var responseString = typeof result === 'string' ? result : GraphiQL.formatResult(result);\n\n        _this.safeSetState({\n          schema: undefined,\n          response: responseString\n        });\n      }\n    }).catch(function (error) {\n      _this.safeSetState({\n        schema: undefined,\n        response: error ? GraphiQL.formatError(error) : undefined\n      });\n    });\n  };\n\n  GraphiQL.prototype._fetchQuery = function (query, variables, headers, operationName, shouldPersistHeaders, cb) {\n    var _this = this;\n\n    var fetcher = this.props.fetcher;\n    var jsonVariables = null;\n    var jsonHeaders = null;\n\n    try {\n      jsonVariables = variables && variables.trim() !== '' ? JSON.parse(variables) : null;\n    } catch (error) {\n      throw new Error(\"Variables are invalid JSON: \" + error.message + \".\");\n    }\n\n    if (typeof jsonVariables !== 'object') {\n      throw new Error('Variables are not a JSON object.');\n    }\n\n    try {\n      jsonHeaders = headers && headers.trim() !== '' ? JSON.parse(headers) : null;\n    } catch (error) {\n      throw new Error(\"Headers are invalid JSON: \" + error.message + \".\");\n    }\n\n    if (typeof jsonHeaders !== 'object') {\n      throw new Error('Headers are not a JSON object.');\n    }\n\n    var fetch = fetcher({\n      query: query,\n      variables: jsonVariables,\n      operationName: operationName\n    }, {\n      headers: jsonHeaders,\n      shouldPersistHeaders: shouldPersistHeaders\n    });\n\n    if (isPromise(fetch)) {\n      fetch.then(cb).catch(function (error) {\n        _this.safeSetState({\n          isWaitingForResponse: false,\n          response: error ? GraphiQL.formatError(error) : undefined\n        });\n      });\n    } else if (isObservable(fetch)) {\n      var subscription = fetch.subscribe({\n        next: cb,\n        error: function (error) {\n          _this.safeSetState({\n            isWaitingForResponse: false,\n            response: error ? GraphiQL.formatError(error) : undefined,\n            subscription: null\n          });\n        },\n        complete: function () {\n          _this.safeSetState({\n            isWaitingForResponse: false,\n            subscription: null\n          });\n        }\n      });\n      return subscription;\n    } else {\n      throw new Error('Fetcher did not return Promise or Observable.');\n    }\n  };\n\n  GraphiQL.prototype._runQueryAtCursor = function () {\n    if (this.state.subscription) {\n      this.handleStopQuery();\n      return;\n    }\n\n    var operationName;\n    var operations = this.state.operations;\n\n    if (operations) {\n      var editor = this.getQueryEditor();\n\n      if (editor && editor.hasFocus()) {\n        var cursor = editor.getCursor();\n        var cursorIndex = editor.indexFromPos(cursor);\n\n        for (var i = 0; i < operations.length; i++) {\n          var operation = operations[i];\n\n          if (operation.loc && operation.loc.start <= cursorIndex && operation.loc.end >= cursorIndex) {\n            operationName = operation.name && operation.name.value;\n            break;\n          }\n        }\n      }\n    }\n\n    this.handleRunQuery(operationName);\n  };\n\n  GraphiQL.prototype._didClickDragBar = function (event) {\n    if (event.button !== 0 || event.ctrlKey) {\n      return false;\n    }\n\n    var target = event.target;\n\n    if (target.className.indexOf('CodeMirror-gutter') !== 0) {\n      return false;\n    }\n\n    var resultWindow = this.resultViewerElement;\n\n    while (target) {\n      if (target === resultWindow) {\n        return true;\n      }\n\n      target = target.parentNode;\n    }\n\n    return false;\n  };\n\n  GraphiQL.Logo = GraphiQLLogo;\n  GraphiQL.Toolbar = GraphiQLToolbar;\n  GraphiQL.Footer = GraphiQLFooter;\n  GraphiQL.QueryEditor = QueryEditor;\n  GraphiQL.VariableEditor = VariableEditor;\n  GraphiQL.HeaderEditor = HeaderEditor;\n  GraphiQL.ResultViewer = ResultViewer;\n  GraphiQL.Button = ToolbarButton;\n  GraphiQL.ToolbarButton = ToolbarButton;\n  GraphiQL.Group = ToolbarGroup;\n  GraphiQL.Menu = ToolbarMenu;\n  GraphiQL.MenuItem = ToolbarMenuItem;\n  return GraphiQL;\n}(React.Component);\n\nexport { GraphiQL };\n\nfunction GraphiQLLogo(props) {\n  return React.createElement(\"div\", {\n    className: \"title\"\n  }, props.children || React.createElement(\"span\", null, 'Graph', React.createElement(\"em\", null, 'i'), 'QL'));\n}\n\nGraphiQLLogo.displayName = 'GraphiQLLogo';\n\nfunction GraphiQLToolbar(props) {\n  return React.createElement(\"div\", {\n    className: \"toolbar\",\n    role: \"toolbar\",\n    \"aria-label\": \"Editor Commands\"\n  }, props.children);\n}\n\nGraphiQLToolbar.displayName = 'GraphiQLToolbar';\n\nfunction GraphiQLFooter(props) {\n  return React.createElement(\"div\", {\n    className: \"footer\"\n  }, props.children);\n}\n\nGraphiQLFooter.displayName = 'GraphiQLFooter';\n\nvar formatSingleError = function (error) {\n  return __assign(__assign({}, error), {\n    message: error.message,\n    stack: error.stack\n  });\n};\n\nvar defaultQuery = \"# Welcome to GraphiQL\\n#\\n# GraphiQL is an in-browser tool for writing, validating, and\\n# testing GraphQL queries.\\n#\\n# Type queries into this side of the screen, and you will see intelligent\\n# typeaheads aware of the current GraphQL type schema and live syntax and\\n# validation errors highlighted within the text.\\n#\\n# GraphQL queries typically start with a \\\"{\\\" character. Lines that start\\n# with a # are ignored.\\n#\\n# An example GraphQL query might look like:\\n#\\n#     {\\n#       field(arg: \\\"value\\\") {\\n#         subField\\n#       }\\n#     }\\n#\\n# Keyboard shortcuts:\\n#\\n#  Prettify Query:  Shift-Ctrl-P (or press the prettify button above)\\n#\\n#     Merge Query:  Shift-Ctrl-M (or press the merge button above)\\n#\\n#       Run Query:  Ctrl-Enter (or press the play button above)\\n#\\n#   Auto Complete:  Ctrl-Space (or just start typing)\\n#\\n\\n\";\n\nfunction isPromise(value) {\n  return typeof value === 'object' && typeof value.then === 'function';\n}\n\nfunction observableToPromise(observable) {\n  if (!isObservable(observable)) {\n    return observable;\n  }\n\n  return new Promise(function (resolve, reject) {\n    var subscription = observable.subscribe(function (v) {\n      resolve(v);\n      subscription.unsubscribe();\n    }, reject, function () {\n      reject(new Error('no value resolved'));\n    });\n  });\n}\n\nfunction isObservable(value) {\n  return typeof value === 'object' && 'subscribe' in value && typeof value.subscribe === 'function';\n}\n\nfunction isChildComponentType(child, component) {\n  var _a;\n\n  if (((_a = child === null || child === void 0 ? void 0 : child.type) === null || _a === void 0 ? void 0 : _a.displayName) && child.type.displayName === component.displayName) {\n    return true;\n  }\n\n  return child.type === component;\n}","map":{"version":3,"sources":["../../src/components/GraphiQL.tsx"],"names":[],"mappings":"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","sourceRoot":"","sourcesContent":["var __extends = (this && this.__extends) || (function () {\n    var extendStatics = function (d, b) {\n        extendStatics = Object.setPrototypeOf ||\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\n            function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\n        return extendStatics(d, b);\n    };\n    return function (d, b) {\n        extendStatics(d, b);\n        function __() { this.constructor = d; }\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\n    };\n})();\nvar __assign = (this && this.__assign) || function () {\n    __assign = Object.assign || function(t) {\n        for (var s, i = 1, n = arguments.length; i < n; i++) {\n            s = arguments[i];\n            for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p))\n                t[p] = s[p];\n        }\n        return t;\n    };\n    return __assign.apply(this, arguments);\n};\nimport React from 'react';\nimport { buildClientSchema, parse, print, } from 'graphql';\nimport copyToClipboard from 'copy-to-clipboard';\nimport { ExecuteButton } from './ExecuteButton';\nimport { ImagePreview } from './ImagePreview';\nimport { ToolbarButton } from './ToolbarButton';\nimport { ToolbarGroup } from './ToolbarGroup';\nimport { ToolbarMenu, ToolbarMenuItem } from './ToolbarMenu';\nimport { QueryEditor } from './QueryEditor';\nimport { VariableEditor } from './VariableEditor';\nimport { HeaderEditor } from './HeaderEditor';\nimport { ResultViewer } from './ResultViewer';\nimport { DocExplorer } from './DocExplorer';\nimport { QueryHistory } from './QueryHistory';\nimport CodeMirrorSizer from '../utility/CodeMirrorSizer';\nimport StorageAPI from '../utility/StorageAPI';\nimport getQueryFacts from '../utility/getQueryFacts';\nimport getSelectedOperationName from '../utility/getSelectedOperationName';\nimport debounce from '../utility/debounce';\nimport find from '../utility/find';\nimport { fillLeafs } from '../utility/fillLeafs';\nimport { getLeft, getTop } from '../utility/elementPosition';\nimport mergeAST from '../utility/mergeAst';\nimport { introspectionQuery, introspectionQueryName, introspectionQuerySansSubscriptions, } from '../utility/introspectionQueries';\nvar DEFAULT_DOC_EXPLORER_WIDTH = 350;\nvar majorVersion = parseInt(React.version.slice(0, 2), 10);\nif (majorVersion < 16) {\n    throw Error([\n        'GraphiQL 0.18.0 and after is not compatible with React 15 or below.',\n        'If you are using a CDN source (jsdelivr, unpkg, etc), follow this example:',\n        'https://github.com/graphql/graphiql/blob/master/examples/graphiql-cdn/index.html#L49',\n    ].join('\\n'));\n}\nvar GraphiQL = (function (_super) {\n    __extends(GraphiQL, _super);\n    function GraphiQL(props) {\n        var _a, _b;\n        var _this = _super.call(this, props) || this;\n        _this._editorQueryID = 0;\n        _this.safeSetState = function (nextState, callback) {\n            _this.componentIsMounted && _this.setState(nextState, callback);\n        };\n        _this.handleClickReference = function (reference) {\n            _this.setState({ docExplorerOpen: true }, function () {\n                if (_this.docExplorerComponent) {\n                    _this.docExplorerComponent.showDocForReference(reference);\n                }\n            });\n            _this._storage.set('docExplorerOpen', JSON.stringify(_this.state.docExplorerOpen));\n        };\n        _this.handleRunQuery = function (selectedOperationName) {\n            _this._editorQueryID++;\n            var queryID = _this._editorQueryID;\n            var editedQuery = _this.autoCompleteLeafs() || _this.state.query;\n            var variables = _this.state.variables;\n            var headers = _this.state.headers;\n            var shouldPersistHeaders = _this.state.shouldPersistHeaders;\n            var operationName = _this.state.operationName;\n            if (selectedOperationName && selectedOperationName !== operationName) {\n                operationName = selectedOperationName;\n                _this.handleEditOperationName(operationName);\n            }\n            try {\n                _this.setState({\n                    isWaitingForResponse: true,\n                    response: undefined,\n                    operationName: operationName,\n                });\n                _this._storage.set('operationName', operationName);\n                if (_this._queryHistory) {\n                    _this._queryHistory.updateHistory(editedQuery, variables, headers, operationName);\n                }\n                var subscription = _this._fetchQuery(editedQuery, variables, headers, operationName, shouldPersistHeaders, function (result) {\n                    if (queryID === _this._editorQueryID) {\n                        _this.setState({\n                            isWaitingForResponse: false,\n                            response: GraphiQL.formatResult(result),\n                        });\n                    }\n                });\n                _this.setState({ subscription: subscription });\n            }\n            catch (error) {\n                _this.setState({\n                    isWaitingForResponse: false,\n                    response: error.message,\n                });\n            }\n        };\n        _this.handleStopQuery = function () {\n            var subscription = _this.state.subscription;\n            _this.setState({\n                isWaitingForResponse: false,\n                subscription: null,\n            });\n            if (subscription) {\n                subscription.unsubscribe();\n            }\n        };\n        _this.handlePrettifyQuery = function () {\n            var _a, _b, _c;\n            var editor = _this.getQueryEditor();\n            var editorContent = (_a = editor === null || editor === void 0 ? void 0 : editor.getValue()) !== null && _a !== void 0 ? _a : '';\n            var prettifiedEditorContent = print(parse(editorContent));\n            if (prettifiedEditorContent !== editorContent) {\n                editor === null || editor === void 0 ? void 0 : editor.setValue(prettifiedEditorContent);\n            }\n            var variableEditor = _this.getVariableEditor();\n            var variableEditorContent = (_b = variableEditor === null || variableEditor === void 0 ? void 0 : variableEditor.getValue()) !== null && _b !== void 0 ? _b : '';\n            try {\n                var prettifiedVariableEditorContent = JSON.stringify(JSON.parse(variableEditorContent), null, 2);\n                if (prettifiedVariableEditorContent !== variableEditorContent) {\n                    variableEditor === null || variableEditor === void 0 ? void 0 : variableEditor.setValue(prettifiedVariableEditorContent);\n                }\n            }\n            catch (_d) {\n            }\n            var headerEditor = _this.getHeaderEditor();\n            var headerEditorContent = (_c = headerEditor === null || headerEditor === void 0 ? void 0 : headerEditor.getValue()) !== null && _c !== void 0 ? _c : '';\n            try {\n                var prettifiedHeaderEditorContent = JSON.stringify(JSON.parse(headerEditorContent), null, 2);\n                if (prettifiedHeaderEditorContent !== headerEditorContent) {\n                    headerEditor === null || headerEditor === void 0 ? void 0 : headerEditor.setValue(prettifiedHeaderEditorContent);\n                }\n            }\n            catch (_e) {\n            }\n        };\n        _this.handleMergeQuery = function () {\n            var editor = _this.getQueryEditor();\n            var query = editor.getValue();\n            if (!query) {\n                return;\n            }\n            var ast = parse(query);\n            editor.setValue(print(mergeAST(ast)));\n        };\n        _this.handleEditQuery = debounce(100, function (value) {\n            var queryFacts = _this._updateQueryFacts(value, _this.state.operationName, _this.state.operations, _this.state.schema);\n            _this.setState(__assign({ query: value }, queryFacts));\n            _this._storage.set('query', value);\n            if (_this.props.onEditQuery) {\n                return _this.props.onEditQuery(value);\n            }\n        });\n        _this.handleCopyQuery = function () {\n            var editor = _this.getQueryEditor();\n            var query = editor && editor.getValue();\n            if (!query) {\n                return;\n            }\n            copyToClipboard(query);\n            if (_this.props.onCopyQuery) {\n                return _this.props.onCopyQuery(query);\n            }\n        };\n        _this._updateQueryFacts = function (query, operationName, prevOperations, schema) {\n            var queryFacts = getQueryFacts(schema, query);\n            if (queryFacts) {\n                var updatedOperationName = getSelectedOperationName(prevOperations, operationName, queryFacts.operations);\n                var onEditOperationName = _this.props.onEditOperationName;\n                if (onEditOperationName &&\n                    updatedOperationName &&\n                    operationName !== updatedOperationName) {\n                    onEditOperationName(updatedOperationName);\n                }\n                return __assign({ operationName: updatedOperationName }, queryFacts);\n            }\n        };\n        _this.handleEditVariables = function (value) {\n            _this.setState({ variables: value });\n            debounce(500, function () { return _this._storage.set('variables', value); })();\n            if (_this.props.onEditVariables) {\n                _this.props.onEditVariables(value);\n            }\n        };\n        _this.handleEditHeaders = function (value) {\n            _this.setState({ headers: value });\n            _this.props.shouldPersistHeaders &&\n                debounce(500, function () { return _this._storage.set('headers', value); })();\n            if (_this.props.onEditHeaders) {\n                _this.props.onEditHeaders(value);\n            }\n        };\n        _this.handleEditOperationName = function (operationName) {\n            var onEditOperationName = _this.props.onEditOperationName;\n            if (onEditOperationName) {\n                onEditOperationName(operationName);\n            }\n        };\n        _this.handleHintInformationRender = function (elem) {\n            elem.addEventListener('click', _this._onClickHintInformation);\n            var onRemoveFn;\n            elem.addEventListener('DOMNodeRemoved', (onRemoveFn = function () {\n                elem.removeEventListener('DOMNodeRemoved', onRemoveFn);\n                elem.removeEventListener('click', _this._onClickHintInformation);\n            }));\n        };\n        _this.handleEditorRunQuery = function () {\n            _this._runQueryAtCursor();\n        };\n        _this._onClickHintInformation = function (event) {\n            if ((event === null || event === void 0 ? void 0 : event.currentTarget) &&\n                'className' in event.currentTarget &&\n                event.currentTarget.className === 'typeName') {\n                var typeName = event.currentTarget.innerHTML;\n                var schema = _this.state.schema;\n                if (schema) {\n                    var type_1 = schema.getType(typeName);\n                    if (type_1) {\n                        _this.setState({ docExplorerOpen: true }, function () {\n                            if (_this.docExplorerComponent) {\n                                _this.docExplorerComponent.showDoc(type_1);\n                            }\n                        });\n                        debounce(500, function () {\n                            return _this._storage.set('docExplorerOpen', JSON.stringify(_this.state.docExplorerOpen));\n                        })();\n                    }\n                }\n            }\n        };\n        _this.handleToggleDocs = function () {\n            if (typeof _this.props.onToggleDocs === 'function') {\n                _this.props.onToggleDocs(!_this.state.docExplorerOpen);\n            }\n            _this._storage.set('docExplorerOpen', JSON.stringify(!_this.state.docExplorerOpen));\n            _this.setState({ docExplorerOpen: !_this.state.docExplorerOpen });\n        };\n        _this.handleToggleHistory = function () {\n            if (typeof _this.props.onToggleHistory === 'function') {\n                _this.props.onToggleHistory(!_this.state.historyPaneOpen);\n            }\n            _this._storage.set('historyPaneOpen', JSON.stringify(!_this.state.historyPaneOpen));\n            _this.setState({ historyPaneOpen: !_this.state.historyPaneOpen });\n        };\n        _this.handleSelectHistoryQuery = function (query, variables, headers, operationName) {\n            if (query) {\n                _this.handleEditQuery(query);\n            }\n            if (variables) {\n                _this.handleEditVariables(variables);\n            }\n            if (headers) {\n                _this.handleEditHeaders(headers);\n            }\n            if (operationName) {\n                _this.handleEditOperationName(operationName);\n            }\n        };\n        _this.handleResizeStart = function (downEvent) {\n            if (!_this._didClickDragBar(downEvent)) {\n                return;\n            }\n            downEvent.preventDefault();\n            var offset = downEvent.clientX - getLeft(downEvent.target);\n            var onMouseMove = function (moveEvent) {\n                if (moveEvent.buttons === 0) {\n                    return onMouseUp();\n                }\n                var editorBar = _this.editorBarComponent;\n                var leftSize = moveEvent.clientX - getLeft(editorBar) - offset;\n                var rightSize = editorBar.clientWidth - leftSize;\n                _this.setState({ editorFlex: leftSize / rightSize });\n                debounce(500, function () {\n                    return _this._storage.set('editorFlex', JSON.stringify(_this.state.editorFlex));\n                })();\n            };\n            var onMouseUp = function () {\n                document.removeEventListener('mousemove', onMouseMove);\n                document.removeEventListener('mouseup', onMouseUp);\n                onMouseMove = null;\n                onMouseUp = null;\n            };\n            document.addEventListener('mousemove', onMouseMove);\n            document.addEventListener('mouseup', onMouseUp);\n        };\n        _this.handleResetResize = function () {\n            _this.setState({ editorFlex: 1 });\n            _this._storage.set('editorFlex', JSON.stringify(_this.state.editorFlex));\n        };\n        _this.handleDocsResizeStart = function (downEvent) {\n            downEvent.preventDefault();\n            var hadWidth = _this.state.docExplorerWidth;\n            var offset = downEvent.clientX - getLeft(downEvent.target);\n            var onMouseMove = function (moveEvent) {\n                if (moveEvent.buttons === 0) {\n                    return onMouseUp();\n                }\n                var app = _this.graphiqlContainer;\n                var cursorPos = moveEvent.clientX - getLeft(app) - offset;\n                var docsSize = app.clientWidth - cursorPos;\n                if (docsSize < 100) {\n                    _this.setState({ docExplorerOpen: false });\n                }\n                else {\n                    _this.setState({\n                        docExplorerOpen: true,\n                        docExplorerWidth: Math.min(docsSize, 650),\n                    });\n                    debounce(500, function () {\n                        return _this._storage.set('docExplorerWidth', JSON.stringify(_this.state.docExplorerWidth));\n                    })();\n                }\n                _this._storage.set('docExplorerOpen', JSON.stringify(_this.state.docExplorerOpen));\n            };\n            var onMouseUp = function () {\n                if (!_this.state.docExplorerOpen) {\n                    _this.setState({ docExplorerWidth: hadWidth });\n                    debounce(500, function () {\n                        return _this._storage.set('docExplorerWidth', JSON.stringify(_this.state.docExplorerWidth));\n                    })();\n                }\n                document.removeEventListener('mousemove', onMouseMove);\n                document.removeEventListener('mouseup', onMouseUp);\n                onMouseMove = null;\n                onMouseUp = null;\n            };\n            document.addEventListener('mousemove', onMouseMove);\n            document.addEventListener('mouseup', onMouseUp);\n        };\n        _this.handleDocsResetResize = function () {\n            _this.setState({\n                docExplorerWidth: DEFAULT_DOC_EXPLORER_WIDTH,\n            });\n            debounce(500, function () {\n                return _this._storage.set('docExplorerWidth', JSON.stringify(_this.state.docExplorerWidth));\n            })();\n        };\n        _this.handleTabClickPropogation = function (downEvent) {\n            downEvent.preventDefault();\n            downEvent.stopPropagation();\n        };\n        _this.handleOpenHeaderEditorTab = function (_clickEvent) {\n            _this.setState({\n                headerEditorActive: true,\n                variableEditorActive: false,\n                secondaryEditorOpen: true,\n            });\n        };\n        _this.handleOpenVariableEditorTab = function (_clickEvent) {\n            _this.setState({\n                headerEditorActive: false,\n                variableEditorActive: true,\n                secondaryEditorOpen: true,\n            });\n        };\n        _this.handleSecondaryEditorResizeStart = function (downEvent) {\n            downEvent.preventDefault();\n            var didMove = false;\n            var wasOpen = _this.state.secondaryEditorOpen;\n            var hadHeight = _this.state.secondaryEditorHeight;\n            var offset = downEvent.clientY - getTop(downEvent.target);\n            var onMouseMove = function (moveEvent) {\n                if (moveEvent.buttons === 0) {\n                    return onMouseUp();\n                }\n                didMove = true;\n                var editorBar = _this.editorBarComponent;\n                var topSize = moveEvent.clientY - getTop(editorBar) - offset;\n                var bottomSize = editorBar.clientHeight - topSize;\n                if (bottomSize < 60) {\n                    _this.setState({\n                        secondaryEditorOpen: false,\n                        secondaryEditorHeight: hadHeight,\n                    });\n                }\n                else {\n                    _this.setState({\n                        secondaryEditorOpen: true,\n                        secondaryEditorHeight: bottomSize,\n                    });\n                }\n                debounce(500, function () {\n                    return _this._storage.set('secondaryEditorHeight', JSON.stringify(_this.state.secondaryEditorHeight));\n                })();\n            };\n            var onMouseUp = function () {\n                if (!didMove) {\n                    _this.setState({ secondaryEditorOpen: !wasOpen });\n                }\n                document.removeEventListener('mousemove', onMouseMove);\n                document.removeEventListener('mouseup', onMouseUp);\n                onMouseMove = null;\n                onMouseUp = null;\n            };\n            document.addEventListener('mousemove', onMouseMove);\n            document.addEventListener('mouseup', onMouseUp);\n        };\n        if (typeof props.fetcher !== 'function') {\n            throw new TypeError('GraphiQL requires a fetcher function.');\n        }\n        _this._storage = new StorageAPI(props.storage);\n        _this.componentIsMounted = false;\n        var query = props.query !== undefined\n            ? props.query\n            : _this._storage.get('query')\n                ? _this._storage.get('query')\n                : props.defaultQuery !== undefined\n                    ? props.defaultQuery\n                    : defaultQuery;\n        var queryFacts = getQueryFacts(props.schema, query);\n        var variables = props.variables !== undefined\n            ? props.variables\n            : _this._storage.get('variables');\n        var headers = props.headers !== undefined\n            ? props.headers\n            : _this._storage.get('headers');\n        var operationName = props.operationName !== undefined\n            ? props.operationName\n            : getSelectedOperationName(undefined, _this._storage.get('operationName'), queryFacts && queryFacts.operations);\n        var docExplorerOpen = props.docExplorerOpen || false;\n        if (_this._storage.get('docExplorerOpen')) {\n            docExplorerOpen = _this._storage.get('docExplorerOpen') === 'true';\n        }\n        var secondaryEditorOpen;\n        if (props.defaultVariableEditorOpen !== undefined) {\n            secondaryEditorOpen = props.defaultVariableEditorOpen;\n        }\n        else if (props.defaultSecondaryEditorOpen !== undefined) {\n            secondaryEditorOpen = props.defaultSecondaryEditorOpen;\n        }\n        else {\n            secondaryEditorOpen = Boolean(variables || headers);\n        }\n        var headerEditorEnabled = (_a = props.headerEditorEnabled) !== null && _a !== void 0 ? _a : false;\n        var shouldPersistHeaders = (_b = props.shouldPersistHeaders) !== null && _b !== void 0 ? _b : false;\n        _this.state = __assign({ schema: props.schema, query: query, variables: variables, headers: headers, operationName: operationName,\n            docExplorerOpen: docExplorerOpen, response: props.response, editorFlex: Number(_this._storage.get('editorFlex')) || 1, secondaryEditorOpen: secondaryEditorOpen, secondaryEditorHeight: Number(_this._storage.get('secondaryEditorHeight')) || 200, variableEditorActive: _this._storage.get('variableEditorActive') === 'true' ||\n                props.headerEditorEnabled\n                ? _this._storage.get('headerEditorActive') !== 'true'\n                : secondaryEditorOpen && true, headerEditorActive: _this._storage.get('headerEditorActive') === 'true', headerEditorEnabled: headerEditorEnabled,\n            shouldPersistHeaders: shouldPersistHeaders, historyPaneOpen: _this._storage.get('historyPaneOpen') === 'true' || false, docExplorerWidth: Number(_this._storage.get('docExplorerWidth')) ||\n                DEFAULT_DOC_EXPLORER_WIDTH, isWaitingForResponse: false, subscription: null }, queryFacts);\n        return _this;\n    }\n    GraphiQL.formatResult = function (result) {\n        return JSON.stringify(result, null, 2);\n    };\n    GraphiQL.formatError = function (rawError) {\n        var result = Array.isArray(rawError)\n            ? rawError.map(formatSingleError)\n            : formatSingleError(rawError);\n        return JSON.stringify(result, null, 2);\n    };\n    GraphiQL.prototype.componentDidMount = function () {\n        this.componentIsMounted = true;\n        if (this.state.schema === undefined) {\n            this.fetchSchema();\n        }\n        this.codeMirrorSizer = new CodeMirrorSizer();\n        global.g = this;\n    };\n    GraphiQL.prototype.UNSAFE_componentWillMount = function () {\n        this.componentIsMounted = false;\n    };\n    GraphiQL.prototype.UNSAFE_componentWillReceiveProps = function (nextProps) {\n        var _this = this;\n        var nextSchema = this.state.schema;\n        var nextQuery = this.state.query;\n        var nextVariables = this.state.variables;\n        var nextHeaders = this.state.headers;\n        var nextOperationName = this.state.operationName;\n        var nextResponse = this.state.response;\n        if (nextProps.schema !== undefined) {\n            nextSchema = nextProps.schema;\n        }\n        if (nextProps.query !== undefined && this.props.query !== nextProps.query) {\n            nextQuery = nextProps.query;\n        }\n        if (nextProps.variables !== undefined &&\n            this.props.variables !== nextProps.variables) {\n            nextVariables = nextProps.variables;\n        }\n        if (nextProps.headers !== undefined &&\n            this.props.headers !== nextProps.headers) {\n            nextHeaders = nextProps.headers;\n        }\n        if (nextProps.operationName !== undefined) {\n            nextOperationName = nextProps.operationName;\n        }\n        if (nextProps.response !== undefined) {\n            nextResponse = nextProps.response;\n        }\n        if (nextQuery &&\n            nextSchema &&\n            (nextSchema !== this.state.schema ||\n                nextQuery !== this.state.query ||\n                nextOperationName !== this.state.operationName)) {\n            var updatedQueryAttributes = this._updateQueryFacts(nextQuery, nextOperationName, this.state.operations, nextSchema);\n            if (updatedQueryAttributes !== undefined) {\n                nextOperationName = updatedQueryAttributes.operationName;\n                this.setState(updatedQueryAttributes);\n            }\n        }\n        if (nextProps.schema === undefined &&\n            nextProps.fetcher !== this.props.fetcher) {\n            nextSchema = undefined;\n        }\n        this._storage.set('operationName', nextOperationName);\n        this.setState({\n            schema: nextSchema,\n            query: nextQuery,\n            variables: nextVariables,\n            headers: nextHeaders,\n            operationName: nextOperationName,\n            response: nextResponse,\n        }, function () {\n            if (_this.state.schema === undefined) {\n                if (_this.docExplorerComponent) {\n                    _this.docExplorerComponent.reset();\n                }\n                _this.fetchSchema();\n            }\n        });\n    };\n    GraphiQL.prototype.componentDidUpdate = function () {\n        this.codeMirrorSizer.updateSizes([\n            this.queryEditorComponent,\n            this.variableEditorComponent,\n            this.headerEditorComponent,\n            this.resultComponent,\n        ]);\n    };\n    GraphiQL.prototype.render = function () {\n        var _this = this;\n        var children = React.Children.toArray(this.props.children);\n        var logo = find(children, function (child) {\n            return isChildComponentType(child, GraphiQL.Logo);\n        }) || React.createElement(GraphiQL.Logo, null);\n        var toolbar = find(children, function (child) {\n            return isChildComponentType(child, GraphiQL.Toolbar);\n        }) || (React.createElement(GraphiQL.Toolbar, null,\n            React.createElement(ToolbarButton, { onClick: this.handlePrettifyQuery, title: \"Prettify Query (Shift-Ctrl-P)\", label: \"Prettify\" }),\n            React.createElement(ToolbarButton, { onClick: this.handleMergeQuery, title: \"Merge Query (Shift-Ctrl-M)\", label: \"Merge\" }),\n            React.createElement(ToolbarButton, { onClick: this.handleCopyQuery, title: \"Copy Query (Shift-Ctrl-C)\", label: \"Copy\" }),\n            React.createElement(ToolbarButton, { onClick: this.handleToggleHistory, title: \"Show History\", label: \"History\" })));\n        var footer = find(children, function (child) {\n            return isChildComponentType(child, GraphiQL.Footer);\n        });\n        var queryWrapStyle = {\n            WebkitFlex: this.state.editorFlex,\n            flex: this.state.editorFlex,\n        };\n        var docWrapStyle = {\n            display: 'block',\n            width: this.state.docExplorerWidth,\n        };\n        var docExplorerWrapClasses = 'docExplorerWrap' +\n            (this.state.docExplorerWidth < 200 ? ' doc-explorer-narrow' : '');\n        var historyPaneStyle = {\n            display: this.state.historyPaneOpen ? 'block' : 'none',\n            width: '230px',\n            zIndex: 7,\n        };\n        var secondaryEditorOpen = this.state.secondaryEditorOpen;\n        var secondaryEditorStyle = {\n            height: secondaryEditorOpen\n                ? this.state.secondaryEditorHeight\n                : undefined,\n        };\n        return (React.createElement(\"div\", { ref: function (n) {\n                _this.graphiqlContainer = n;\n            }, className: \"graphiql-container\" },\n            React.createElement(\"div\", { className: \"historyPaneWrap\", style: historyPaneStyle },\n                React.createElement(QueryHistory, { ref: function (node) {\n                        _this._queryHistory = node;\n                    }, operationName: this.state.operationName, query: this.state.query, variables: this.state.variables, onSelectQuery: this.handleSelectHistoryQuery, storage: this._storage, queryID: this._editorQueryID },\n                    React.createElement(\"button\", { className: \"docExplorerHide\", onClick: this.handleToggleHistory, \"aria-label\": \"Close History\" }, '\\u2715'))),\n            React.createElement(\"div\", { className: \"editorWrap\" },\n                React.createElement(\"div\", { className: \"topBarWrap\" },\n                    React.createElement(\"div\", { className: \"topBar\" },\n                        logo,\n                        React.createElement(ExecuteButton, { isRunning: Boolean(this.state.subscription), onRun: this.handleRunQuery, onStop: this.handleStopQuery, operations: this.state.operations }),\n                        toolbar),\n                    !this.state.docExplorerOpen && (React.createElement(\"button\", { className: \"docExplorerShow\", onClick: this.handleToggleDocs, \"aria-label\": \"Open Documentation Explorer\" }, 'Docs'))),\n                React.createElement(\"div\", { ref: function (n) {\n                        _this.editorBarComponent = n;\n                    }, className: \"editorBar\", onDoubleClick: this.handleResetResize, onMouseDown: this.handleResizeStart },\n                    React.createElement(\"div\", { className: \"queryWrap\", style: queryWrapStyle },\n                        React.createElement(QueryEditor, { ref: function (n) {\n                                _this.queryEditorComponent = n;\n                            }, schema: this.state.schema, value: this.state.query, onEdit: this.handleEditQuery, onHintInformationRender: this.handleHintInformationRender, onClickReference: this.handleClickReference, onCopyQuery: this.handleCopyQuery, onPrettifyQuery: this.handlePrettifyQuery, onMergeQuery: this.handleMergeQuery, onRunQuery: this.handleEditorRunQuery, editorTheme: this.props.editorTheme, readOnly: this.props.readOnly }),\n                        React.createElement(\"section\", { className: \"variable-editor secondary-editor\", style: secondaryEditorStyle, \"aria-label\": this.state.variableEditorActive\n                                ? 'Query Variables'\n                                : 'Request Headers' },\n                            React.createElement(\"div\", { className: \"secondary-editor-title variable-editor-title\", id: \"secondary-editor-title\", style: {\n                                    cursor: secondaryEditorOpen ? 'row-resize' : 'n-resize',\n                                }, onMouseDown: this.handleSecondaryEditorResizeStart },\n                                React.createElement(\"div\", { style: {\n                                        cursor: 'pointer',\n                                        color: this.state.variableEditorActive ? '#000' : 'gray',\n                                        display: 'inline-block',\n                                    }, onClick: this.handleOpenVariableEditorTab, onMouseDown: this.handleTabClickPropogation }, 'Query Variables'),\n                                this.state.headerEditorEnabled && (React.createElement(\"div\", { style: {\n                                        cursor: 'pointer',\n                                        color: this.state.headerEditorActive ? '#000' : 'gray',\n                                        display: 'inline-block',\n                                        marginLeft: '20px',\n                                    }, onClick: this.handleOpenHeaderEditorTab, onMouseDown: this.handleTabClickPropogation }, 'Request Headers'))),\n                            React.createElement(VariableEditor, { ref: function (n) {\n                                    _this.variableEditorComponent = n;\n                                }, value: this.state.variables, variableToType: this.state.variableToType, onEdit: this.handleEditVariables, onHintInformationRender: this.handleHintInformationRender, onPrettifyQuery: this.handlePrettifyQuery, onMergeQuery: this.handleMergeQuery, onRunQuery: this.handleEditorRunQuery, editorTheme: this.props.editorTheme, readOnly: this.props.readOnly, active: this.state.variableEditorActive }),\n                            this.state.headerEditorEnabled && (React.createElement(HeaderEditor, { ref: function (n) {\n                                    _this.headerEditorComponent = n;\n                                }, value: this.state.headers, onEdit: this.handleEditHeaders, onHintInformationRender: this.handleHintInformationRender, onPrettifyQuery: this.handlePrettifyQuery, onMergeQuery: this.handleMergeQuery, onRunQuery: this.handleEditorRunQuery, editorTheme: this.props.editorTheme, readOnly: this.props.readOnly, active: this.state.headerEditorActive })))),\n                    React.createElement(\"div\", { className: \"resultWrap\" },\n                        this.state.isWaitingForResponse && (React.createElement(\"div\", { className: \"spinner-container\" },\n                            React.createElement(\"div\", { className: \"spinner\" }))),\n                        React.createElement(ResultViewer, { registerRef: function (n) {\n                                _this.resultViewerElement = n;\n                            }, ref: function (c) {\n                                _this.resultComponent = c;\n                            }, value: this.state.response, editorTheme: this.props.editorTheme, ResultsTooltip: this.props.ResultsTooltip, ImagePreview: ImagePreview }),\n                        footer))),\n            this.state.docExplorerOpen && (React.createElement(\"div\", { className: docExplorerWrapClasses, style: docWrapStyle },\n                React.createElement(\"div\", { className: \"docExplorerResizer\", onDoubleClick: this.handleDocsResetResize, onMouseDown: this.handleDocsResizeStart }),\n                React.createElement(DocExplorer, { ref: function (c) {\n                        _this.docExplorerComponent = c;\n                    }, schema: this.state.schema },\n                    React.createElement(\"button\", { className: \"docExplorerHide\", onClick: this.handleToggleDocs, \"aria-label\": \"Close Documentation Explorer\" }, '\\u2715'))))));\n    };\n    GraphiQL.prototype.getQueryEditor = function () {\n        if (this.queryEditorComponent) {\n            return this.queryEditorComponent.getCodeMirror();\n        }\n    };\n    GraphiQL.prototype.getVariableEditor = function () {\n        if (this.variableEditorComponent) {\n            return this.variableEditorComponent.getCodeMirror();\n        }\n        return null;\n    };\n    GraphiQL.prototype.getHeaderEditor = function () {\n        if (this.headerEditorComponent) {\n            return this.headerEditorComponent.getCodeMirror();\n        }\n        return null;\n    };\n    GraphiQL.prototype.refresh = function () {\n        if (this.queryEditorComponent) {\n            this.queryEditorComponent.getCodeMirror().refresh();\n        }\n        if (this.variableEditorComponent) {\n            this.variableEditorComponent.getCodeMirror().refresh();\n        }\n        if (this.headerEditorComponent) {\n            this.headerEditorComponent.getCodeMirror().refresh();\n        }\n        if (this.resultComponent) {\n            this.resultComponent.getCodeMirror().refresh();\n        }\n    };\n    GraphiQL.prototype.autoCompleteLeafs = function () {\n        var _a = fillLeafs(this.state.schema, this.state.query, this.props.getDefaultFieldNames), insertions = _a.insertions, result = _a.result;\n        if (insertions && insertions.length > 0) {\n            var editor_1 = this.getQueryEditor();\n            if (editor_1) {\n                editor_1.operation(function () {\n                    var cursor = editor_1.getCursor();\n                    var cursorIndex = editor_1.indexFromPos(cursor);\n                    editor_1.setValue(result || '');\n                    var added = 0;\n                    var markers = insertions.map(function (_a) {\n                        var index = _a.index, string = _a.string;\n                        return editor_1.markText(editor_1.posFromIndex(index + added), editor_1.posFromIndex(index + (added += string.length)), {\n                            className: 'autoInsertedLeaf',\n                            clearOnEnter: true,\n                            title: 'Automatically added leaf fields',\n                        });\n                    });\n                    setTimeout(function () { return markers.forEach(function (marker) { return marker.clear(); }); }, 7000);\n                    var newCursorIndex = cursorIndex;\n                    insertions.forEach(function (_a) {\n                        var index = _a.index, string = _a.string;\n                        if (index < cursorIndex) {\n                            newCursorIndex += string.length;\n                        }\n                    });\n                    editor_1.setCursor(editor_1.posFromIndex(newCursorIndex));\n                });\n            }\n        }\n        return result;\n    };\n    GraphiQL.prototype.fetchSchema = function () {\n        var _this = this;\n        var fetcher = this.props.fetcher;\n        var fetcherOpts = {\n            shouldPersistHeaders: Boolean(this.props.shouldPersistHeaders),\n        };\n        if (this.state.headers && this.state.headers.trim().length > 2) {\n            fetcherOpts.headers = JSON.parse(this.state.headers);\n        }\n        else if (this.props.headers) {\n            fetcherOpts.headers = JSON.parse(this.props.headers);\n        }\n        var fetch = observableToPromise(fetcher({\n            query: introspectionQuery,\n            operationName: introspectionQueryName,\n        }, fetcherOpts));\n        if (!isPromise(fetch)) {\n            this.setState({\n                response: 'Fetcher did not return a Promise for introspection.',\n            });\n            return;\n        }\n        fetch\n            .then(function (result) {\n            if (typeof result !== 'string' && 'data' in result) {\n                return result;\n            }\n            var fetch2 = observableToPromise(fetcher({\n                query: introspectionQuerySansSubscriptions,\n                operationName: introspectionQueryName,\n            }, fetcherOpts));\n            if (!isPromise(fetch)) {\n                throw new Error('Fetcher did not return a Promise for introspection.');\n            }\n            return fetch2;\n        })\n            .then(function (result) {\n            if (_this.state.schema !== undefined) {\n                return;\n            }\n            if (typeof result !== 'string' && 'data' in result) {\n                var schema = buildClientSchema(result.data);\n                var queryFacts = getQueryFacts(schema, _this.state.query);\n                _this.safeSetState(__assign({ schema: schema }, queryFacts));\n            }\n            else {\n                var responseString = typeof result === 'string' ? result : GraphiQL.formatResult(result);\n                _this.safeSetState({\n                    schema: undefined,\n                    response: responseString,\n                });\n            }\n        })\n            .catch(function (error) {\n            _this.safeSetState({\n                schema: undefined,\n                response: error ? GraphiQL.formatError(error) : undefined,\n            });\n        });\n    };\n    GraphiQL.prototype._fetchQuery = function (query, variables, headers, operationName, shouldPersistHeaders, cb) {\n        var _this = this;\n        var fetcher = this.props.fetcher;\n        var jsonVariables = null;\n        var jsonHeaders = null;\n        try {\n            jsonVariables =\n                variables && variables.trim() !== '' ? JSON.parse(variables) : null;\n        }\n        catch (error) {\n            throw new Error(\"Variables are invalid JSON: \" + error.message + \".\");\n        }\n        if (typeof jsonVariables !== 'object') {\n            throw new Error('Variables are not a JSON object.');\n        }\n        try {\n            jsonHeaders =\n                headers && headers.trim() !== '' ? JSON.parse(headers) : null;\n        }\n        catch (error) {\n            throw new Error(\"Headers are invalid JSON: \" + error.message + \".\");\n        }\n        if (typeof jsonHeaders !== 'object') {\n            throw new Error('Headers are not a JSON object.');\n        }\n        var fetch = fetcher({\n            query: query,\n            variables: jsonVariables,\n            operationName: operationName,\n        }, { headers: jsonHeaders, shouldPersistHeaders: shouldPersistHeaders });\n        if (isPromise(fetch)) {\n            fetch.then(cb).catch(function (error) {\n                _this.safeSetState({\n                    isWaitingForResponse: false,\n                    response: error ? GraphiQL.formatError(error) : undefined,\n                });\n            });\n        }\n        else if (isObservable(fetch)) {\n            var subscription = fetch.subscribe({\n                next: cb,\n                error: function (error) {\n                    _this.safeSetState({\n                        isWaitingForResponse: false,\n                        response: error ? GraphiQL.formatError(error) : undefined,\n                        subscription: null,\n                    });\n                },\n                complete: function () {\n                    _this.safeSetState({\n                        isWaitingForResponse: false,\n                        subscription: null,\n                    });\n                },\n            });\n            return subscription;\n        }\n        else {\n            throw new Error('Fetcher did not return Promise or Observable.');\n        }\n    };\n    GraphiQL.prototype._runQueryAtCursor = function () {\n        if (this.state.subscription) {\n            this.handleStopQuery();\n            return;\n        }\n        var operationName;\n        var operations = this.state.operations;\n        if (operations) {\n            var editor = this.getQueryEditor();\n            if (editor && editor.hasFocus()) {\n                var cursor = editor.getCursor();\n                var cursorIndex = editor.indexFromPos(cursor);\n                for (var i = 0; i < operations.length; i++) {\n                    var operation = operations[i];\n                    if (operation.loc &&\n                        operation.loc.start <= cursorIndex &&\n                        operation.loc.end >= cursorIndex) {\n                        operationName = operation.name && operation.name.value;\n                        break;\n                    }\n                }\n            }\n        }\n        this.handleRunQuery(operationName);\n    };\n    GraphiQL.prototype._didClickDragBar = function (event) {\n        if (event.button !== 0 || event.ctrlKey) {\n            return false;\n        }\n        var target = event.target;\n        if (target.className.indexOf('CodeMirror-gutter') !== 0) {\n            return false;\n        }\n        var resultWindow = this.resultViewerElement;\n        while (target) {\n            if (target === resultWindow) {\n                return true;\n            }\n            target = target.parentNode;\n        }\n        return false;\n    };\n    GraphiQL.Logo = GraphiQLLogo;\n    GraphiQL.Toolbar = GraphiQLToolbar;\n    GraphiQL.Footer = GraphiQLFooter;\n    GraphiQL.QueryEditor = QueryEditor;\n    GraphiQL.VariableEditor = VariableEditor;\n    GraphiQL.HeaderEditor = HeaderEditor;\n    GraphiQL.ResultViewer = ResultViewer;\n    GraphiQL.Button = ToolbarButton;\n    GraphiQL.ToolbarButton = ToolbarButton;\n    GraphiQL.Group = ToolbarGroup;\n    GraphiQL.Menu = ToolbarMenu;\n    GraphiQL.MenuItem = ToolbarMenuItem;\n    return GraphiQL;\n}(React.Component));\nexport { GraphiQL };\nfunction GraphiQLLogo(props) {\n    return (React.createElement(\"div\", { className: \"title\" }, props.children || (React.createElement(\"span\", null,\n        'Graph',\n        React.createElement(\"em\", null, 'i'),\n        'QL'))));\n}\nGraphiQLLogo.displayName = 'GraphiQLLogo';\nfunction GraphiQLToolbar(props) {\n    return (React.createElement(\"div\", { className: \"toolbar\", role: \"toolbar\", \"aria-label\": \"Editor Commands\" }, props.children));\n}\nGraphiQLToolbar.displayName = 'GraphiQLToolbar';\nfunction GraphiQLFooter(props) {\n    return React.createElement(\"div\", { className: \"footer\" }, props.children);\n}\nGraphiQLFooter.displayName = 'GraphiQLFooter';\nvar formatSingleError = function (error) { return (__assign(__assign({}, error), { message: error.message, stack: error.stack })); };\nvar defaultQuery = \"# Welcome to GraphiQL\\n#\\n# GraphiQL is an in-browser tool for writing, validating, and\\n# testing GraphQL queries.\\n#\\n# Type queries into this side of the screen, and you will see intelligent\\n# typeaheads aware of the current GraphQL type schema and live syntax and\\n# validation errors highlighted within the text.\\n#\\n# GraphQL queries typically start with a \\\"{\\\" character. Lines that start\\n# with a # are ignored.\\n#\\n# An example GraphQL query might look like:\\n#\\n#     {\\n#       field(arg: \\\"value\\\") {\\n#         subField\\n#       }\\n#     }\\n#\\n# Keyboard shortcuts:\\n#\\n#  Prettify Query:  Shift-Ctrl-P (or press the prettify button above)\\n#\\n#     Merge Query:  Shift-Ctrl-M (or press the merge button above)\\n#\\n#       Run Query:  Ctrl-Enter (or press the play button above)\\n#\\n#   Auto Complete:  Ctrl-Space (or just start typing)\\n#\\n\\n\";\nfunction isPromise(value) {\n    return typeof value === 'object' && typeof value.then === 'function';\n}\nfunction observableToPromise(observable) {\n    if (!isObservable(observable)) {\n        return observable;\n    }\n    return new Promise(function (resolve, reject) {\n        var subscription = observable.subscribe(function (v) {\n            resolve(v);\n            subscription.unsubscribe();\n        }, reject, function () {\n            reject(new Error('no value resolved'));\n        });\n    });\n}\nfunction isObservable(value) {\n    return (typeof value === 'object' &&\n        'subscribe' in value &&\n        typeof value.subscribe === 'function');\n}\nfunction isChildComponentType(child, component) {\n    var _a;\n    if (((_a = child === null || child === void 0 ? void 0 : child.type) === null || _a === void 0 ? void 0 : _a.displayName) &&\n        child.type.displayName === component.displayName) {\n        return true;\n    }\n    return child.type === component;\n}\n//# sourceMappingURL=GraphiQL.js.map"]},"metadata":{},"sourceType":"module"}